% !TeX spellcheck = fr_CA
\section{Question 1}
Dans me cas d'une régression, avec l'utilisation d'une optimisation de type Maximisation A Priori, on dispose de la fonction de coût $ E_D $ à minimiser telle que:
$$ E_D(\overrightarrow{w}) = \frac{\beta}{2} \sum_{n=1}^N \left(y(\overrightarrow{x_n}, w) - t_n \right)^2 + \frac{\alpha}{2} \overrightarrow{w}^T \overrightarrow{w} $$
Si l'on écrit: $ \lambda=\frac{\alpha}{\beta} $ et $ y(\overrightarrow{x_n}, w) = \overrightarrow{w}^T \overrightarrow{\phi}(\overrightarrow{x_n}) $
 
$$ \iff \frac{1}{2} \sum_{n=1}^N \left(\overrightarrow{w}^T \overrightarrow{\phi}(\overrightarrow{x_n}) - t_n \right)^2 + \frac{\lambda}{2} \overrightarrow{w}^T \overrightarrow{w} $$

Cette expression est la représentation primale que l'on note $ J(\overrightarrow{w}) $.

\begin{equation}
\begin{split}	
	J(\overrightarrow{w}) &= \frac{1}{2} \sum_{n=1}^N \left(\overrightarrow{w}^T \overrightarrow{\phi}(\overrightarrow{x_n}) - t_n \right)^2 + \frac{\lambda}{2} \overrightarrow{w}^T \overrightarrow{w} \\
	&= \frac{1}{2} \sum_{n=1}^N \left(\overrightarrow{w}^T \overrightarrow{\phi}(\overrightarrow{x_n})^2 \overrightarrow{w} - 2 \overrightarrow{w}^T \overrightarrow{\phi}(\overrightarrow{x_n}) t_n + t_n^2\right) + \frac{\lambda}{2} \overrightarrow{w}^T \overrightarrow{w}
\end{split}
\end{equation}

Afin de déterminer sa représentation duale dans un second temps, on va déterminer $ \overrightarrow{w} $  par le calcul du gradient de $E_D$  par rapport à $ \overrightarrow{w} $ et le forcer à 0.

\begin{equation}
\begin{split}
	\nabla_{\overrightarrow{w}} E_D(\overrightarrow{w}) &= \frac{\partial}{\partial \overrightarrow{w}} \left(\frac{1}{2} \sum_{n=1}^N \left(\overrightarrow{w}^T \overrightarrow{\phi}(\overrightarrow{x_n})^2 \overrightarrow{w} - 2 \overrightarrow{w}^T \overrightarrow{\phi}(\overrightarrow{x_n}) t_n + t_n^2\right) + \frac{\lambda}{2} \overrightarrow{w}^T \overrightarrow{w}\right) = 0 \\
	&\iff \frac{1}{\cancel{2}} \sum_{n=1}^N \left( \cancel{2} \overrightarrow{w}^T \overrightarrow{\phi}(\overrightarrow{x_n})^2 - \cancel{2} \overrightarrow{\phi}(\overrightarrow{x_n}) t_n \right) + \lambda \overrightarrow{w} = 0 \\
	&\iff \sum_{n=1}^N \left( \overrightarrow{w}^T \overrightarrow{\phi}(\overrightarrow{x_n})^2 - \overrightarrow{\phi}(\overrightarrow{x_n}) t_n \right) + \lambda \overrightarrow{w} = 0 \\
	&\iff \sum_{n=1}^N \left( \overrightarrow{w}^T \overrightarrow{\phi}(\overrightarrow{x_n})^2 - \overrightarrow{\phi}(\overrightarrow{x_n}) t_n \right) = - \lambda \overrightarrow{w} \\
	&\iff \overrightarrow{w} = - \frac{1}{\lambda}\sum_{n=1}^N \left( \overrightarrow{w}^T \overrightarrow{\phi}(\overrightarrow{x_n}) -  t_n \right)\overrightarrow{\phi}(\overrightarrow{x_n}) \\
	&\iff \overrightarrow{w} = \sum_{n=1}^N \left( - \frac{\overrightarrow{w}^T \overrightarrow{\phi}(\overrightarrow{x_n}) -  t_n }{\lambda}\overrightarrow{\phi}(\overrightarrow{x_n})\right)
\end{split}
\end{equation}

On peut simplifier cette expression par:
\begin{equation}
\begin{split}
	&\iff \overrightarrow{w} = \sum_{n=1}^N a_n \overrightarrow{\phi}(\overrightarrow{x_n})
\end{split}
\end{equation}
en considérant $a_n$ tel que: $ a_n = - \frac{\overrightarrow{w}^T \overrightarrow{\phi}(\overrightarrow{x_n}) -  t_n }{\lambda}$ 

Aussi, on peut exprimer $ \sum_{n=1}^N \overrightarrow{\phi}(\overrightarrow{x_n}) = \Phi^T $, matrice de design où la $ n^{ieme}$ ligne est donnée par $\overrightarrow{\phi}(\overrightarrow{x_n})^T $. Et $a$ tel que $ \overrightarrow{a} = (a_1, ..., a_N)^T$.
On écrit alors: $\overrightarrow{w} = \Phi^T \overrightarrow{a}$.

Maintenant, revenons à notre représentation primale (sous forme développée) de $J(\overrightarrow{w})$ et exprimons $\overrightarrow{w}$ tel que $\overrightarrow{w} = \Phi^T \overrightarrow{a}$. 
$J$ se devient être exprimé en fonction de $\overrightarrow{a}$. On inscrit: $\Phi^T = \sum_{n=1}^N \overrightarrow{\phi}(\overrightarrow{x_n}) $ et $\overrightarrow{t} = \sum_{n=1}^Nt_n$.

\begin{equation}
\begin{split}
	J(\overrightarrow{a}) = \frac{1}{2} \left[(\Phi \overrightarrow{a}^T)(\Phi^T \Phi)(\Phi^T \overrightarrow{a}) - 2 (\Phi \overrightarrow{a}^T)\Phi^T t + t^T t \right] + \frac{\lambda}{2} (\Phi \overrightarrow{a}^T) (\Phi^T \overrightarrow{a})
\end{split}
\end{equation}

que l'on peut réécrire tel que:

\begin{equation}
\begin{split}
	\iff \frac{1}{2} \overrightarrow{a}^T \Phi \Phi^T \Phi \Phi^T \overrightarrow{a} - \overrightarrow{a}^T \Phi \Phi^T  t + \frac{1}{2} t^T t + {\lambda}{2} \overrightarrow{a}^T \Phi \Phi^T \overrightarrow{a}
\end{split}
\end{equation}
qui etst la représentation duale de $J(\overrightarrow{w})$.